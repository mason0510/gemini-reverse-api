#!/bin/bash
# SSH隧道代理 - 让服务器使用本地ClashX代理
# 保持这个脚本运行，服务器就能通过你的代理访问Gemini

echo "🌉 创建SSH隧道: 服务器8118端口 -> 本地ClashX 7890端口"
echo "⚠️  保持此窗口运行，关闭后隧道会断开"
echo ""
echo "验证命令（在另一个终端执行）："
echo "  ssh root@82.29.54.80 'curl -x http://127.0.0.1:8118 -s https://ifconfig.me'"
echo "  应该输出: 183.192.93.255 (你的ClashX出口IP)"
echo ""
echo "按 Ctrl+C 停止隧道"
echo ""

# 创建SSH反向隧道
# -R 8118:127.0.0.1:7890 = 服务器的8118端口转发到本地的7890端口
# -N = 不执行远程命令，仅转发端口
# -v = 显示详细信息（可选，调试时使用）
ssh -R 8118:127.0.0.1:7890 root@82.29.54.80 -N
